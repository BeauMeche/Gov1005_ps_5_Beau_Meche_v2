---
title: "ps_5_graphic"
author: "Beau Meche"
date: "March 5, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readr)
library(janitor)
library(gt)
library(fs)
library(lubridate)
```

```{r cache=TRUE, echo=FALSE}
data5 <- read_rds("Join2.rds")
```

```{r}
q5<- data5 %>%
  filter(employer == "HARVARD UNIVERSITY") %>%
  filter(!is.na(party)) %>%
  mutate(party = case_when(party %in% c("REP", "rep", "Rep") ~ "Republican", 
                           party %in% c("DEM", "Dem", "dem") ~ "Democrat",
                           TRUE ~ "Other"
                           )) %>%
  mutate(date = parse_date(date, format = "%m %d %Y")) %>%
  mutate(date = cut(date, breaks = "quarters")) %>%
  select(date, occupation, party, amount) %>%
  group_by(occupation) %>%
  mutate(amt = sum(amount)) %>%
  arrange(desc(amt))%>%
  ggplot(aes(x = date, y = amount, color = party), show.legend = FALSE) + geom_jitter(aes(size = amt)) + scale_y_log10()
q5


  
  
  
```



